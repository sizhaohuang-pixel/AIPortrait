# Frontend æ¨¡å— - UniApp å°ç¨‹åºå‰ç«¯

> ğŸ“ **å¯¼èˆª**: [â† è¿”å›é¡¹ç›®æ ¹ç›®å½•](../CLAUDE.md) | [åç«¯æ¨¡å—](../app/CLAUDE.md) | [ç®¡ç†åå°](../web/CLAUDE.md) | [æ•°æ®åº“](../database/CLAUDE.md)

---

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

**æ¨¡å—åç§°**: Frontend (ç”¨æˆ·ä¾§å°ç¨‹åºå‰ç«¯)
**æŠ€æœ¯æ ˆ**: UniApp + Vue 3
**ç›®æ ‡å¹³å°**: å¾®ä¿¡å°ç¨‹åº / H5 / App
**ä¸»è¦èŒè´£**: AI å†™çœŸå°ç¨‹åºç”¨æˆ·ä¾§å‰ç«¯ä¸šåŠ¡

è¿™æ˜¯ AIPortrait é¡¹ç›®çš„ç”¨æˆ·ä¾§å‰ç«¯æ¨¡å—ï¼ŒåŸºäº UniApp æ¡†æ¶å¼€å‘ï¼Œä¸»è¦ç”¨äºæ‰“åŒ…æˆå¾®ä¿¡å°ç¨‹åºï¼Œä¸ºç”¨æˆ·æä¾› AI å†™çœŸç”Ÿæˆã€æ¨¡æ¿é€‰æ‹©ã€å†å²è®°å½•ç­‰åŠŸèƒ½ã€‚

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. é¦–é¡µ (pages/index)
- å±•ç¤º AI å†™çœŸæ¨¡æ¿åˆ—è¡¨
- æ¨¡æ¿åˆ†ç±»ä¸ç­›é€‰
- å¿«é€Ÿè¿›å…¥æ¨¡æ¿è¯¦æƒ…

### 2. æ¨¡æ¿è¯¦æƒ… (pages/template-detail)
- æŸ¥çœ‹æ¨¡æ¿è¯¦ç»†ä¿¡æ¯
- ä¸Šä¼ ç”¨æˆ·ç…§ç‰‡
- å‘èµ· AI å†™çœŸç”Ÿæˆ

### 3. ç”Ÿæˆä¸­ (pages/generating)
- æ˜¾ç¤º AI å†™çœŸç”Ÿæˆè¿›åº¦
- å®æ—¶çŠ¶æ€æ›´æ–°
- ç”Ÿæˆå®Œæˆåè·³è½¬é¢„è§ˆ

### 4. é¢„è§ˆ (pages/preview)
- æŸ¥çœ‹ç”Ÿæˆçš„ AI å†™çœŸ
- ä¿å­˜åˆ°ç›¸å†Œ
- åˆ†äº«åŠŸèƒ½

### 5. å†å²è®°å½• (pages/history)
- æŸ¥çœ‹ç”¨æˆ·å†å²ç”Ÿæˆè®°å½•
- é‡æ–°æŸ¥çœ‹å†å²ä½œå“
- åˆ é™¤å†å²è®°å½•

### 6. æˆ‘çš„ (pages/mine)
- ç”¨æˆ·ä¸ªäººä¿¡æ¯
- è´¦æˆ·ç®¡ç†
- è®¾ç½®ä¸å¸®åŠ©

---

## ğŸ“ ç›®å½•ç»“æ„

```
frontend/
â”œâ”€â”€ pages/                      # é¡µé¢ç›®å½•
â”‚   â”œâ”€â”€ index/                  # é¦–é¡µ
â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”œâ”€â”€ template-detail/        # æ¨¡æ¿è¯¦æƒ…é¡µ
â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”œâ”€â”€ generating/             # ç”Ÿæˆä¸­é¡µé¢
â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”œâ”€â”€ preview/                # é¢„è§ˆé¡µé¢
â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â”œâ”€â”€ history/                # å†å²è®°å½•é¡µ
â”‚   â”‚   â””â”€â”€ index.vue
â”‚   â””â”€â”€ mine/                   # æˆ‘çš„é¡µé¢
â”‚       â””â”€â”€ index.vue
â”œâ”€â”€ components/                 # å…¬å…±ç»„ä»¶
â”‚   â””â”€â”€ SkeletonLoader.vue      # éª¨æ¶å±åŠ è½½ç»„ä»¶
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ history.js              # å†å²è®°å½•ç®¡ç†å·¥å…·
â”œâ”€â”€ data/                       # æ•°æ®/Mock
â”‚   â””â”€â”€ mock.js                 # æ¨¡æ‹Ÿæ•°æ®
â”œâ”€â”€ static/                     # é™æ€èµ„æº
â”‚   â””â”€â”€ icons/                  # å›¾æ ‡èµ„æº
â”‚       â”œâ”€â”€ home.png
â”‚       â”œâ”€â”€ home-active.png
â”‚       â”œâ”€â”€ user.png
â”‚       â””â”€â”€ user-active.png
â”œâ”€â”€ App.vue                     # åº”ç”¨å…¥å£ç»„ä»¶
â”œâ”€â”€ main.js                     # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ pages.json                  # é¡µé¢è·¯ç”±é…ç½®
â”œâ”€â”€ manifest.json               # åº”ç”¨é…ç½®æ¸…å•
â”œâ”€â”€ uni.scss                    # å…¨å±€æ ·å¼å˜é‡
â”œâ”€â”€ uni.promisify.adaptor.js    # Promise é€‚é…å™¨
â””â”€â”€ index.html                  # H5 å…¥å£é¡µé¢
```

---

## ğŸš€ å¯åŠ¨ä¸è¿è¡Œ

### å¼€å‘ç¯å¢ƒè¦æ±‚
- **HBuilderX** (æ¨è) æˆ– UniApp CLI
- **Node.js** 14+ (å¦‚ä½¿ç”¨ CLI)
- **å¾®ä¿¡å¼€å‘è€…å·¥å…·** (ç”¨äºå°ç¨‹åºè°ƒè¯•)

### ä½¿ç”¨ HBuilderX è¿è¡Œ

1. **è¿è¡Œåˆ° H5**
   - æ‰“å¼€ HBuilderX
   - é€‰æ‹© `è¿è¡Œ` â†’ `è¿è¡Œåˆ°æµè§ˆå™¨` â†’ `Chrome`

2. **è¿è¡Œåˆ°å¾®ä¿¡å°ç¨‹åº**
   - æ‰“å¼€ HBuilderX
   - é€‰æ‹© `è¿è¡Œ` â†’ `è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨` â†’ `å¾®ä¿¡å¼€å‘è€…å·¥å…·`
   - ç¡®ä¿å·²é…ç½®å¾®ä¿¡å¼€å‘è€…å·¥å…·è·¯å¾„

3. **æ‰“åŒ…å‘å¸ƒ**
   - é€‰æ‹© `å‘è¡Œ` â†’ `å°ç¨‹åº-å¾®ä¿¡`
   - é…ç½®å°ç¨‹åº AppID (åœ¨ `manifest.json` ä¸­)

### ä½¿ç”¨ CLI è¿è¡Œ (å¯é€‰)

å¦‚æœé¡¹ç›®é…ç½®äº† CLI è„šæœ¬ï¼š

```bash
# è¿è¡Œåˆ° H5
npm run dev:h5

# è¿è¡Œåˆ°å¾®ä¿¡å°ç¨‹åº
npm run dev:mp-weixin

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build:mp-weixin
```

> âš ï¸ **æ³¨æ„**: å½“å‰é¡¹ç›®é»˜è®¤ä½¿ç”¨ HBuilderXï¼ŒCLI è„šæœ¬éœ€è¦è‡ªè¡Œæ·»åŠ ã€‚

---

## ğŸ”Œ å¯¹å¤–æ¥å£

### API è°ƒç”¨
- **åŸºç¡€ URL**: é…ç½®åœ¨ `utils/` æˆ–ç¯å¢ƒå˜é‡ä¸­
- **è¯·æ±‚æ–¹å¼**: ä½¿ç”¨ `uni.request()` è¿›è¡Œ HTTP è¯·æ±‚
- **ä¸»è¦æ¥å£**:
  - `GET /api/templates` - è·å–æ¨¡æ¿åˆ—è¡¨
  - `GET /api/template/:id` - è·å–æ¨¡æ¿è¯¦æƒ…
  - `POST /api/generate` - å‘èµ· AI å†™çœŸç”Ÿæˆ
  - `GET /api/history` - è·å–å†å²è®°å½•
  - `GET /api/user/info` - è·å–ç”¨æˆ·ä¿¡æ¯

### é¡µé¢è·¯ç”±
- **è·¯ç”±é…ç½®**: `pages.json`
- **å¯¼èˆªæ–¹å¼**:
  - `uni.navigateTo()` - ä¿ç•™å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢
  - `uni.redirectTo()` - å…³é—­å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªé¡µé¢
  - `uni.switchTab()` - è·³è½¬åˆ° tabBar é¡µé¢

### TabBar é…ç½®
- **é¦–é¡µ** (`pages/index/index`)
- **æˆ‘çš„** (`pages/mine/index`)

---

## ğŸ“¦ å…³é”®ä¾èµ–

### æ ¸å¿ƒæ¡†æ¶
- **Vue 3** - å‰ç«¯æ¡†æ¶ (vueVersion: 3)
- **UniApp** - è·¨å¹³å°å¼€å‘æ¡†æ¶

### å¹³å°æ”¯æŒ
- **å¾®ä¿¡å°ç¨‹åº** (mp-weixin)
- **æ”¯ä»˜å®å°ç¨‹åº** (mp-alipay)
- **ç™¾åº¦å°ç¨‹åº** (mp-baidu)
- **å­—èŠ‚è·³åŠ¨å°ç¨‹åº** (mp-toutiao)
- **H5** (web)
- **App** (app-plus)

### é…ç½®æ–‡ä»¶
- `manifest.json` - åº”ç”¨é…ç½®æ¸…å•
  - AppID: `__UNI__5EEB0F4`
  - ç‰ˆæœ¬: `1.0.0`
  - å¾®ä¿¡å°ç¨‹åºé…ç½®: `mp-weixin`
- `pages.json` - é¡µé¢è·¯ç”±ä¸ TabBar é…ç½®

---

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹

### æœ¬åœ°å­˜å‚¨
ä½¿ç”¨ `uni.setStorageSync()` / `uni.getStorageSync()` è¿›è¡Œæœ¬åœ°æ•°æ®å­˜å‚¨ï¼š

- **ç”¨æˆ·ä¿¡æ¯**: `userInfo`
- **å†å²è®°å½•**: `history` (é€šè¿‡ `utils/history.js` ç®¡ç†)
- **ä¸´æ—¶æ•°æ®**: é¡µé¢é—´ä¼ é€’çš„ä¸´æ—¶æ•°æ®

### é¡µé¢æ•°æ®æµ
- **é¦–é¡µ â†’ æ¨¡æ¿è¯¦æƒ…**: ä¼ é€’æ¨¡æ¿ ID
- **æ¨¡æ¿è¯¦æƒ… â†’ ç”Ÿæˆä¸­**: ä¼ é€’ç”Ÿæˆä»»åŠ¡ ID
- **ç”Ÿæˆä¸­ â†’ é¢„è§ˆ**: ä¼ é€’ç”Ÿæˆç»“æœ ID
- **é¢„è§ˆ â†’ å†å²è®°å½•**: ä¿å­˜åˆ°å†å²è®°å½•

---

## ğŸ§ª æµ‹è¯•ä¸è´¨é‡

### å½“å‰çŠ¶æ€
âš ï¸ **æœªé…ç½®æµ‹è¯•æ¡†æ¶**

### å»ºè®®æ·»åŠ 
1. **å•å…ƒæµ‹è¯•**: ä½¿ç”¨ `@vue/test-utils` + `vitest`
2. **E2E æµ‹è¯•**: ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è‡ªåŠ¨åŒ–æµ‹è¯•
3. **ä»£ç è§„èŒƒ**: æ·»åŠ  ESLint + Prettier

### è´¨é‡æ£€æŸ¥
```bash
# å»ºè®®æ·»åŠ çš„è„šæœ¬
npm run lint        # ä»£ç æ£€æŸ¥
npm run test        # è¿è¡Œæµ‹è¯•
npm run test:e2e    # E2E æµ‹è¯•
```

---

## ğŸ¨ ç¼–ç è§„èŒƒ

### Vue ç»„ä»¶è§„èŒƒ
- ä½¿ç”¨ **SFC (Single File Component)** æ ¼å¼
- ç»„ä»¶ç»“æ„: `<template>` â†’ `<script>` â†’ `<style scoped>`
- ä½¿ç”¨ **Tab ç¼©è¿›** (ä¿æŒä¸ç°æœ‰ä»£ç ä¸€è‡´)

### å‘½åè§„èŒƒ
- **ç›®å½•**: kebab-case (ä¾‹: `template-detail`)
- **æ–‡ä»¶**: å°å†™ (ä¾‹: `index.vue`)
- **å˜é‡**: camelCase (ä¾‹: `templateId`)
- **ç»„ä»¶**: PascalCase (ä¾‹: `SkeletonLoader`)

### å¯¼å…¥è§„èŒƒ
- ä½¿ç”¨ ES æ¨¡å—å¯¼å…¥
- æ˜¾å¼æŒ‡å®šæ–‡ä»¶æ‰©å±•å (`.vue`, `.js`)
- ç¤ºä¾‹: `import SkeletonLoader from '@/components/SkeletonLoader.vue'`

### å‡½æ•°å£°æ˜
- ä¼˜å…ˆä½¿ç”¨ `function` å£°æ˜ (ä¿æŒ `this` è¡Œä¸ºä¸€è‡´)
- é¿å…ç®­å¤´å‡½æ•°åœ¨éœ€è¦ `this` çš„åœºæ™¯

---

## âš™ï¸ é…ç½®è¯´æ˜

### å¾®ä¿¡å°ç¨‹åºé…ç½®
åœ¨ `manifest.json` ä¸­é…ç½®ï¼š

```json
"mp-weixin": {
  "appid": "",  // éœ€è¦å¡«å†™å¾®ä¿¡å°ç¨‹åº AppID
  "setting": {
    "urlCheck": false  // å¼€å‘æ—¶å…³é—­ URL æ ¡éªŒ
  }
}
```

### å›¾ç‰‡åŸŸåç™½åå•
âš ï¸ **é‡è¦**: å°ç¨‹åºä¸­ä½¿ç”¨çš„å¤–éƒ¨å›¾ç‰‡åŸŸåå¿…é¡»åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®ç™½åå•

**ç”Ÿäº§ç¯å¢ƒå»ºè®®**:
- å°†å¤–éƒ¨å›¾ç‰‡ URL æ›¿æ¢ä¸ºè‡ªå·±çš„ CDN/OSS åŸŸå
- åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®æœåŠ¡å™¨åŸŸåç™½åå•

### å…¨å±€æ ·å¼é…ç½®
åœ¨ `pages.json` ä¸­é…ç½®ï¼š

```json
"globalStyle": {
  "navigationBarTextStyle": "black",
  "navigationBarTitleText": "AIå†™çœŸ",
  "navigationBarBackgroundColor": "#F8F8F8",
  "backgroundColor": "#F8F8F8"
}
```

---

## ğŸ”§ å¸¸è§é—®é¢˜ (FAQ)

### Q1: å¦‚ä½•é…ç½®å¾®ä¿¡å°ç¨‹åº AppIDï¼Ÿ
**A**: åœ¨ `manifest.json` çš„ `mp-weixin.appid` å­—æ®µä¸­å¡«å†™ä½ çš„å°ç¨‹åº AppIDã€‚

### Q2: å¦‚ä½•æ·»åŠ æ–°é¡µé¢ï¼Ÿ
**A**:
1. åœ¨ `pages/` ç›®å½•ä¸‹åˆ›å»ºæ–°é¡µé¢æ–‡ä»¶å¤¹
2. åœ¨ `pages.json` çš„ `pages` æ•°ç»„ä¸­æ·»åŠ é¡µé¢é…ç½®
3. é…ç½®é¡µé¢æ ‡é¢˜å’Œæ ·å¼

### Q3: å¦‚ä½•è°ƒè¯•å°ç¨‹åºï¼Ÿ
**A**:
1. ä½¿ç”¨ HBuilderX è¿è¡Œåˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹æ§åˆ¶å°å’Œç½‘ç»œè¯·æ±‚
3. ä½¿ç”¨ `console.log()` è¿›è¡Œè°ƒè¯•

### Q4: å¦‚ä½•å¤„ç†è·¨åŸŸé—®é¢˜ï¼Ÿ
**A**:
- å°ç¨‹åºä¸å­˜åœ¨è·¨åŸŸé—®é¢˜
- H5 å¼€å‘æ—¶éœ€è¦é…ç½®ä»£ç†æˆ–åç«¯ CORS

### Q5: å¦‚ä½•ä¼˜åŒ–å°ç¨‹åºæ€§èƒ½ï¼Ÿ
**A**:
- ä½¿ç”¨åˆ†åŒ…åŠ è½½ (subPackages)
- å›¾ç‰‡æ‡’åŠ è½½
- å‡å°‘ setData è°ƒç”¨é¢‘ç‡
- ä½¿ç”¨éª¨æ¶å±æå‡ç”¨æˆ·ä½“éªŒ

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶
- `App.vue` - åº”ç”¨å…¥å£ç»„ä»¶
- `main.js` - åº”ç”¨å…¥å£æ–‡ä»¶
- `pages.json` - é¡µé¢è·¯ç”±é…ç½®
- `manifest.json` - åº”ç”¨é…ç½®æ¸…å•

### é¡µé¢æ–‡ä»¶
- `pages/index/index.vue` - é¦–é¡µ
- `pages/template-detail/index.vue` - æ¨¡æ¿è¯¦æƒ…
- `pages/generating/index.vue` - ç”Ÿæˆä¸­
- `pages/preview/index.vue` - é¢„è§ˆ
- `pages/history/index.vue` - å†å²è®°å½•
- `pages/mine/index.vue` - æˆ‘çš„

### å·¥å…·æ–‡ä»¶
- `utils/history.js` - å†å²è®°å½•ç®¡ç†
- `uni.promisify.adaptor.js` - Promise é€‚é…å™¨

### æ ·å¼æ–‡ä»¶
- `uni.scss` - å…¨å±€æ ·å¼å˜é‡

---

## ğŸ“ å˜æ›´è®°å½•

### v1.0.0 (2026-02-03)
- âœ… åˆå§‹åŒ– UniApp é¡¹ç›®
- âœ… å®Œæˆ 6 ä¸ªæ ¸å¿ƒé¡µé¢å¼€å‘
- âœ… å®ç° TabBar å¯¼èˆª
- âœ… æ·»åŠ éª¨æ¶å±ç»„ä»¶
- âœ… é…ç½®å¾®ä¿¡å°ç¨‹åºæ”¯æŒ

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [UniApp å®˜æ–¹æ–‡æ¡£](https://uniapp.dcloud.net.cn/)
- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://cn.vuejs.org/)
- [å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/)
- [é¡¹ç›®æ ¹ç›®å½•æ–‡æ¡£](../CLAUDE.md)
- [åç«¯ API æ–‡æ¡£](../app/CLAUDE.md)

---

**æœ€åæ›´æ–°**: 2026-02-03
**ç»´æŠ¤è€…**: AIPortrait Team
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
